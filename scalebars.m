function [sx, sy] = scalebars(axeshandle, orig, percents, units, fontname, fontsize, linewidth, precision);%% [sx, sy] = scalebars(axeshandle, orig, percents, units, fontname, fontsize, linewidth); % place scale bars on the axes specified by axeshandle, using the units of the target axis% place their origin at the (x,y) location in the vector orig (default is [0 0])% optionally make them have dimensions of percents = [xpercent and ypercent] of the total x&y axis limits.% Returns structs with handles, etc% units is a cell of strings that specifies the units to be printed after the scale values% fontname is a string containing the desired fontname% fontsize and linewidth are doubles containing the desired values% precision is a cell containg text formating precision commands, e.g., {'%2.0f', '%2.1f'}% % MJones 2001-2009% % example:%     t = [0:0.1:2*pi];%     plot(t, cos(t)); axis off%     [sx, sy] = scalebars(gca); hold on    % shows defaults%     [sx, sy] = scalebars(gca, [pi, 0.5], [20, 10], {'ms', 'mV'}, 'times', 18, 5, {'%2.1f', '%2.1f'})if ~exist('orig');          orig        = [0 0];                            endif ~exist('percents');  	xpercent    = 0.1; ypercent = 0.1;              endif ~exist('units');         units       = {'ms', 'mV'};                     endif ~exist('fontname');      fontname    = 'times';                          endif ~exist('fontsize');      fontsize	= 12;                               endif ~exist('linewidth');     linewidth	= 2;                                endif ~exist('precision');     precision	= {'%2.2f', '%2.2f'};            	endif exist('percents'); 	xpercent = 0.01.*percents(1); ypercent = 0.01.*percents(2); endxlims = get(axeshandle, 'xlim');ylims = get(axeshandle, 'ylim');xl = xpercent .* [max(xlims) - min(xlims)];yl = ypercent .* [max(ylims) - min(ylims)];a = [orig(1) orig(1)+xl];b = [orig(2) orig(2)];c = [orig(1) orig(1)];d = [orig(2) orig(2)+yl];axes(axeshandle)sx.line = line(a, b, 'color', 'k', 'linewidth', linewidth); hold onsy.line = line(c, d, 'color', 'k', 'linewidth', linewidth);sx.xlab = [num2str(xl, precision{1}) char(32) units{1}];sy.ylab = [num2str(yl, precision{2}) char(32) units{2}];sx.text = text(	a(1)+0.1.*xl, d(1)+0.001.*yl, ...				sx.xlab, 'horiz', 'left', 'vert', 'bottom', ...				'fontname', fontname, 'fontsize', fontsize);sy.text = text(	a(1)+0.1.*xl, d(1)+0.5.*yl, ...				sy.ylab, 'horiz', 'left', 'vert', 'bottom', ...				'fontname', fontname, 'fontsize', fontsize);